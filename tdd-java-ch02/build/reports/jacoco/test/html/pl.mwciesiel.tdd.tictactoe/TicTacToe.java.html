<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TicTacToe.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">tdd-course</a> &gt; <a href="index.source.html" class="el_package">pl.mwciesiel.tdd.tictactoe</a> &gt; <span class="el_source">TicTacToe.java</span></div><h1>TicTacToe.java</h1><pre class="source lang-java linenums">package pl.mwciesiel.tdd.tictactoe;

<span class="fc" id="L3">public class TicTacToe {</span>

<span class="fc" id="L5">    private Character[][] board = {</span>
<span class="fc" id="L6">            {'\0', '\0', '\0'},</span>
<span class="fc" id="L7">            {'\0', '\0', '\0'},</span>
<span class="fc" id="L8">            {'\0', '\0', '\0'}</span>
    };
<span class="fc" id="L10">    private int movesCounter = 0;</span>

<span class="fc" id="L12">    private final static int[][][] winningCombinations = {</span>
            {{0, 0}, {0, 1}, {0, 2}},
            {{1, 0}, {1, 1}, {1, 2}},
            {{2, 0}, {2, 1}, {2, 2}},

            {{0, 0}, {1, 0}, {2, 0}},
            {{0, 1}, {1, 1}, {2, 1}},
            {{0, 2}, {1, 2}, {2, 2}},

            {{0, 0}, {1, 1}, {2, 2}},
            {{0, 2}, {1, 1}, {2, 0}},
    };

<span class="fc" id="L25">    private Character currentPlayer = 'X';</span>

    public String play(int y, int x) {
<span class="fc" id="L28">        checkAxis(x, &quot;X&quot;);</span>
<span class="fc" id="L29">        checkAxis(y, &quot;Y&quot;);</span>
<span class="fc" id="L30">        doMove(x, y);</span>
<span class="fc" id="L31">        boolean isWin = checkWinner();</span>
<span class="fc bfc" id="L32" title="All 2 branches covered.">        if(isWin) {</span>
<span class="fc" id="L33">            return &quot;Wygrał &quot; + currentPlayer;</span>
        }
<span class="fc" id="L35">        switchPlayer();</span>
<span class="fc bfc" id="L36" title="All 2 branches covered.">        if(isDraw()) {</span>
<span class="fc" id="L37">            return &quot;Remis&quot;;</span>
        }
<span class="fc" id="L39">        return &quot;Brak zwycięzcy&quot;;</span>
    }

    private boolean checkWinner() {
<span class="fc bfc" id="L43" title="All 2 branches covered.">        for (int[][] c : winningCombinations) {</span>
<span class="fc bfc" id="L44" title="All 6 branches covered.">            if (board[c[0][0]][c[0][1]] == currentPlayer &amp;&amp;</span>
                    board[c[1][0]][c[1][1]] == currentPlayer &amp;&amp;
                    board[c[2][0]][c[2][1]] == currentPlayer) {
<span class="fc" id="L47">                return true;</span>
            }
        }
<span class="fc" id="L50">        return false;</span>
    }

    private void checkAxis(int index, String axis) {
<span class="pc bpc" id="L54" title="1 of 4 branches missed.">        if (index &lt; 1 || index &gt; 3) {</span>
<span class="fc" id="L55">            throw new RuntimeException(String.format(&quot;Wartość %s wykracza poza planszę!&quot;, axis));</span>
        }
<span class="fc" id="L57">    }</span>

    private void doMove(int x, int y) {
<span class="fc bfc" id="L60" title="All 2 branches covered.">        if (board[y - 1][x - 1] != '\0') {</span>
<span class="fc" id="L61">            throw new RuntimeException(String.format(&quot;Pole (%d, %d) jest już zajęte&quot;, y, x));</span>
        }
<span class="fc" id="L63">        board[y - 1][x - 1] = currentPlayer;</span>
<span class="fc" id="L64">    }</span>

    private void switchPlayer() {
<span class="fc bfc" id="L67" title="All 2 branches covered.">        if (currentPlayer == 'X') {</span>
<span class="fc" id="L68">            currentPlayer = 'O';</span>
        } else {
<span class="fc" id="L70">            currentPlayer = 'X';</span>
        }
<span class="fc" id="L72">    }</span>

    private boolean isDraw() {
<span class="fc bfc" id="L75" title="All 2 branches covered.">        return ++movesCounter &gt;= 9;</span>
    }

    public Character nextPlayer() {
<span class="fc" id="L79">        return currentPlayer;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.1.201803210924</span></div></body></html>